services:
  _defaults:
    # autoconfigure must be on
    autoconfigure: true

  logger.channel.audiodescription:
    parent: logger.channel_base
    arguments: [ 'audiodescription' ]

  audiodescription.cnc_csv_importer:
    class: Drupal\audiodescription\Importer\Movie\CncCsvImporter
    arguments:
      - '@entity_type.manager'
      - '@audiodescription.parser.csv'
      - '@audiodescription.manager.director'
      - '@audiodescription.manager.genre'
      - '@audiodescription.manager.movie'
      - '@audiodescription.manager.nationality'
      - '@audiodescription.manager.public'
      - '%cnc_movies_file%'

  audiodescription.public_csv_importer:
    class: Drupal\audiodescription\Importer\Public\PublicCsvImporter
    arguments:
      - '@entity_type.manager'
      - '@audiodescription.parser.csv'
      - '@audiodescription.manager.public'
      - '%cnc_publics_file%'

  audiodescription.importer_factory:
    class: Drupal\audiodescription\Importer\Movie\ImporterFactory
    arguments:
      - '@audiodescription.cnc_csv_importer'

  audiodescription.manager.director:
    class: Drupal\audiodescription\Manager\DirectorManager
    arguments:
      - '@entity_type.manager'

  audiodescription.manager.genre:
    class: Drupal\audiodescription\Manager\GenreManager
    arguments:
      - '@entity_type.manager'

  audiodescription.manager.movie:
    class: Drupal\audiodescription\Manager\MovieManager
    arguments:
      - '@entity_type.manager'

  audiodescription.manager.nationality:
    class: Drupal\audiodescription\Manager\NationalityManager
    arguments:
      - '@entity_type.manager'

  audiodescription.manager.public:
    class: Drupal\audiodescription\Manager\PublicManager
    arguments:
      - '@entity_type.manager'

  audiodescription.parser.csv:
    class: Drupal\audiodescription\Parser\CsvParser

  audiodescription.movie.breadcrumb:
    class: Drupal\audiodescription\Breadcrumb\MovieBreadcrumbBuilder
    tags:
      - { name: breadcrumb_builder, priority: 100 }

  audiodescription.node.breadcrumb:
    class: Drupal\audiodescription\Breadcrumb\NodeBreadcrumbBuilder
    arguments: ['@entity_type.manager', '@menu.link_tree']
    tags:
      - { name: breadcrumb_builder, priority: 100 }

  audiodescription.view.breadcrumb:
    class: Drupal\audiodescription\Breadcrumb\ViewBreadcrumbBuilder
    arguments: ['@entity_type.manager', '@menu.link_tree']
    tags:
      - { name: breadcrumb_builder, priority: 100 }

  audiodescription.genre.breadcrumb:
    class: Drupal\audiodescription\Breadcrumb\GenreBreadcrumbBuilder
    tags:
      - { name: breadcrumb_builder, priority: 1010 }

  audiodescription.collection.breadcrumb:
    class: Drupal\audiodescription\Breadcrumb\CollectionBreadcrumbBuilder
    tags:
      - { name: breadcrumb_builder, priority: 1010 }

parameters:
  cnc_movies_file: 'modules/custom/audiodescription/files/full-movies.csv'
  cnc_publics_file: 'modules/custom/audiodescription/files/publics.csv'
